---
phase: 03-quarterly-rankings
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - frontend/project/components/RankingsNav.tsx
  - frontend/project/components/YearSelector.tsx
  - frontend/project/components/QuarterShortcuts.tsx
  - frontend/project/app/rankings/layout.tsx
autonomous: true

must_haves:
  truths:
    - "User sees horizontal tabs for All Time, Q1, Q2, Q3, Q4 on rankings pages"
    - "User can click tabs to navigate between quarters"
    - "User sees year dropdown that changes the year for quarterly tabs"
    - "User sees Current Quarter and Last Quarter shortcut buttons"
    - "Future quarters are hidden from tabs (only completed + current visible)"
    - "All Time tab ignores year selector"
  artifacts:
    - path: "frontend/project/components/RankingsNav.tsx"
      provides: "Tab navigation component with ARIA roles"
      exports: ["RankingsNav"]
      contains: "role=\"tablist\""
    - path: "frontend/project/components/YearSelector.tsx"
      provides: "Year dropdown component"
      exports: ["YearSelector"]
      contains: "<select"
    - path: "frontend/project/components/QuarterShortcuts.tsx"
      provides: "Current/Last quarter shortcut buttons"
      exports: ["QuarterShortcuts"]
      contains: "Current Quarter"
    - path: "frontend/project/app/rankings/layout.tsx"
      provides: "Rankings layout with navigation integrated"
      contains: "RankingsNav"
  key_links:
    - from: "frontend/project/components/RankingsNav.tsx"
      to: "frontend/project/lib/quarters.ts"
      via: "import quarter utilities"
      pattern: "getCurrentQuarter|isValidQuarter"
    - from: "frontend/project/app/rankings/layout.tsx"
      to: "frontend/project/components/RankingsNav.tsx"
      via: "import RankingsNav"
      pattern: "<RankingsNav"
---

<objective>
Build the complete navigation UI for quarterly rankings: accessible tab bar, year selector dropdown, and shortcut buttons for quick access.

Purpose: Enable users to navigate between quarters (QRANK-01), select different years (QRANK-04), and quickly jump to current/last quarter (QRANK-06, QRANK-07).

Output: Three navigation components integrated into rankings layout - users can click through all quarters and years.
</objective>

<execution_context>
@/home/tdolfen/.claude/get-shit-done/workflows/execute-plan.md
@/home/tdolfen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-quarterly-rankings/03-CONTEXT.md
@.planning/phases/03-quarterly-rankings/03-RESEARCH.md
@.planning/phases/03-quarterly-rankings/03-01-SUMMARY.md
@frontend/project/lib/quarters.ts
@frontend/project/app/rankings/layout.tsx
@frontend/project/components/ThemeToggle.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create navigation components (tabs, year selector, shortcuts)</name>
  <files>
    frontend/project/components/RankingsNav.tsx
    frontend/project/components/YearSelector.tsx
    frontend/project/components/QuarterShortcuts.tsx
  </files>
  <action>
Create three client components ("use client") for rankings navigation:

**YearSelector.tsx:**
- Props: `selectedYear: number`, `onChange: (year: number) => void`, `disabled?: boolean`
- Render a `<select>` dropdown with years from 2020 to current year
- Style using CSS variables: `backgroundColor: 'hsl(var(--card))'`, `borderColor: 'hsl(var(--border))'`, `color: 'hsl(var(--card-foreground))'`
- Add `aria-label="Select year"` for accessibility
- When disabled (for All Time view), add `opacity-50 cursor-not-allowed` classes
- Tailwind classes: `px-3 py-1.5 rounded-md text-sm font-medium border cursor-pointer`

**QuarterShortcuts.tsx:**
- Props: `currentQuarter: { year: number; quarter: number }`, `lastQuarter: { year: number; quarter: number }`, `activeYear: number`, `activeQuarter: number | 'all'`
- Render two Link buttons: "Current Quarter" and "Last Quarter"
- Determine active state: isCurrentActive when activeYear/activeQuarter matches currentQuarter, isLastActive when matches lastQuarter
- Style active buttons with `backgroundColor: 'hsl(var(--primary))'`, `color: 'hsl(var(--primary-foreground))'`
- Style inactive buttons with `backgroundColor: 'hsl(var(--secondary))'`, `color: 'hsl(var(--secondary-foreground))'`
- Link hrefs: `/rankings/${year}/q${quarter}`
- Tailwind: `px-4 py-2 rounded-md text-sm font-semibold transition-colors`

**RankingsNav.tsx:**
- Props: `activeTab: 'all' | 'q1' | 'q2' | 'q3' | 'q4'`, `activeYear: number`
- Import and use YearSelector and QuarterShortcuts
- Use `useRouter` from 'next/navigation' for year changes (navigate to same quarter, new year)
- Use `usePathname` to determine current route
- Calculate current quarter and previous quarter using lib/quarters utilities
- Determine which quarter tabs to show: all quarters up to and including current quarter for current year, all 4 quarters for past years
- Render structure:
  ```
  <div>
    <QuarterShortcuts ... />
    <div className="flex items-center gap-4">
      <YearSelector ... disabled={activeTab === 'all'} />
      <nav role="tablist" aria-label="Rankings period">
        {tabs.map(tab => <Link role="tab" aria-selected={...} />)}
      </nav>
    </div>
  </div>
  ```
- Tab items: "All Time" -> /rankings/all, "Q1" -> /rankings/{year}/q1, etc.
- Active tab styling: `backgroundColor: 'hsl(var(--primary))'`, border-bottom accent
- Inactive tab styling: transparent background, `color: 'hsl(var(--muted-foreground))'`
- When year changes and current tab is a quarter, navigate to `/rankings/${newYear}/q${activeQuarter}`
- When year changes and current tab is "All Time", do nothing (All Time ignores year)
  </action>
  <verify>
Run: `cd /home/tdolfen/Projects/github.com/BeerBILabs/frontend/project && npx tsc --noEmit components/RankingsNav.tsx components/YearSelector.tsx components/QuarterShortcuts.tsx`
TypeScript compiles without errors.
  </verify>
  <done>Three navigation components created with proper ARIA attributes, beer-themed styling, and correct Link navigation.</done>
</task>

<task type="auto">
  <name>Task 2: Integrate navigation into rankings layout</name>
  <files>frontend/project/app/rankings/layout.tsx</files>
  <action>
Update rankings/layout.tsx to include navigation:

1. Convert to client component with "use client" at top
2. Import RankingsNav from '@/components/RankingsNav'
3. Use `usePathname` from 'next/navigation' to parse current route
4. Parse pathname to determine:
   - If /rankings/all -> activeTab = 'all', activeYear = current year (ignored)
   - If /rankings/YYYY/qN -> activeTab = 'qN', activeYear = YYYY
   - Default (shouldn't happen due to redirect) -> current quarter
5. Render RankingsNav above children:
   ```tsx
   <div className="w-full max-w-4xl mx-auto px-4 py-6">
     <h1 className="text-2xl font-bold mb-6" style={{ color: 'hsl(var(--primary))' }}>
       Rankings
     </h1>
     <RankingsNav activeTab={activeTab} activeYear={activeYear} />
     <div className="mt-6">
       {children}
     </div>
   </div>
   ```
6. Style container to match main page card aesthetic
  </action>
  <verify>
1. Dev server running, navigate to /rankings/2026/q1
2. See tabs: All Time | Q1 (only Q1 visible if current quarter is Q1)
3. See year dropdown showing 2026
4. See "Current Quarter" and "Last Quarter" buttons
5. Click "All Time" tab -> navigates to /rankings/all, year dropdown disabled
6. Click Q1 tab -> navigates to /rankings/2026/q1
7. Change year to 2025 -> navigates to /rankings/2025/q1, all 4 quarters visible
  </verify>
  <done>Rankings layout shows full navigation with tabs, year selector, and shortcuts. Navigation between routes works correctly.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run build` succeeds in frontend/project
2. Manual testing flow:
   - /rankings -> redirects to current quarter
   - Tabs visible: All Time and quarters up to current
   - Click All Time -> /rankings/all, year dropdown disabled
   - Click Q1 -> /rankings/2026/q1, year dropdown enabled
   - Change year to 2025 -> URL becomes /rankings/2025/q1, all 4 quarters visible
   - Click "Current Quarter" button -> jumps to current quarter
   - Click "Last Quarter" button -> jumps to previous quarter
3. Keyboard navigation works (Tab through buttons/links)
</verification>

<success_criteria>
- RankingsNav, YearSelector, QuarterShortcuts components exist
- Tab navigation uses ARIA roles (tablist, tab, aria-selected)
- Year selector dropdown updates URL when changed
- Future quarters are hidden for current year
- All Time tab disables year selector
- Shortcut buttons highlight when viewing that quarter
- All styling uses beer-themed CSS variables
</success_criteria>

<output>
After completion, create `.planning/phases/03-quarterly-rankings/03-02-SUMMARY.md`
</output>
